CREATE TABLE `goods_express_delivery` (
  `auto_id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `id` varchar(64) DEFAULT '',
  `shop_id` varchar(64) DEFAULT '' COMMENT '商户编号',
  `store_id` varchar(64) DEFAULT '' COMMENT '门店ID',
  `goods_id` varchar(64) DEFAULT '' COMMENT '商品id',
  `delivery_type` int(2) DEFAULT '1' COMMENT '商品配送方式(1:快递配送，2：用户到店，3：商家配送, 4:系统配送)',
  `is_free` tinyint(1) DEFAULT '0' COMMENT '是否包邮',
  `freight_template_id` varchar(64) DEFAULT NULL COMMENT '运费模板编号',
  `area_template_id` varchar(64) DEFAULT NULL COMMENT '区域模板编号',
  `merchant_delivery_time_id` varchar(64) DEFAULT NULL COMMENT '配送时间对象',
  `weight` int(10) DEFAULT '0' COMMENT '重量(单位：克)',
  `is_all_store` tinyint(1) DEFAULT '0' COMMENT '是否所有门店',
  `is_required_user_name` tinyint(1) DEFAULT '0' COMMENT '用户是否必填',
  `is_required_phone` tinyint(1) DEFAULT '0' COMMENT '电话是否必填',
  PRIMARY KEY (`auto_id`),
  KEY `goods_express_delivery_id` (`id`) USING BTREE,
  KEY `idx_goods_express_delivery_goods_id` (`goods_id`) USING BTREE,
  KEY `idx_goods_express_delivery_shop_id_store_id` (`shop_id`,`store_id`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=218 DEFAULT CHARSET=utf8 COMMENT='商品配送表'


Create Table

CREATE TABLE `orders` (
  `order_id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT '订单id',
  `order_no` varchar(32) DEFAULT '' COMMENT '订单编号生成规则：yymmdd+9位序列号',
  `buyer_id` bigint(20) DEFAULT NULL COMMENT '买家id',
  `shop_id` varchar(46) DEFAULT NULL COMMENT '订单所属商家id',
  `store_id` varchar(46) DEFAULT NULL COMMENT '订单所属门店id',
  `arrive_store_id` varchar(46) DEFAULT NULL COMMENT '用户到店:门店编号',
  `arrive_store_name` varchar(255) DEFAULT NULL COMMENT '用户到店:门店名称',
  `status` tinyint(3) DEFAULT NULL COMMENT '0=未付款;1=已取消(商家删除);2=未发货;3=已发货;4=已签收;5=已取消(用户删除); 6=等待商家同意退款;7=等待买家退货;8=等待商家收货9=退款成功;',
  `order_type` tinyint(3) DEFAULT NULL COMMENT '订单类型:1=快递配送2=用户到店3=商家配送4=动态',
  `deal_type` tinyint(3) DEFAULT NULL COMMENT '用户付款方式:1=线上2=线下',
  `dy_order_type` tinyint(3) DEFAULT '0' COMMENT '动态订单类型:1=购买2=许愿3=送礼4秒杀5=套餐6=预售8=抱团',
  `pay_way` tinyint(3) DEFAULT '0' COMMENT '支付方式1=支付宝2=微信支付3=到店付款4=货到付款5=储值卡余额支付6=线上抵扣(积分,红包,现金券抵扣)',
  `delivery` tinyint(3) DEFAULT NULL COMMENT '配送方式1=快递配送2=用户到店3=商家配送4=系统配送',
  `shopde_time` varchar(255) DEFAULT NULL COMMENT '商家配送时:用户指定的配送时间,空为任何时间',
  `user_store_time` varchar(32) DEFAULT NULL COMMENT '用户到店时:选择的提货日期',
  `total` int(11) DEFAULT NULL COMMENT '购买商品总数',
  `goods_amount` bigint(20) DEFAULT NULL COMMENT '购买商品总价,单位为分',
  `freight` bigint(20) DEFAULT NULL COMMENT '运费,单位为分',
  `amount` bigint(20) DEFAULT NULL COMMENT '订单应付金额,单位为分',
  `old_amount` bigint(20) DEFAULT NULL COMMENT '最开始下单时的实际付款金额,amount原始记录,单位为分',
  `discount_fee` bigint(20) DEFAULT NULL COMMENT '1折扣额,单位为分',
  `exchange_fee` bigint(20) DEFAULT NULL COMMENT '2积分兑换金额,单位为分',
  `red_pack_fee` bigint(20) DEFAULT NULL COMMENT '3红包抵扣金额,单位为分',
  `cash_coupon_fee` bigint(20) DEFAULT NULL COMMENT '4现金券抵扣金额,单位为分',
  `prepaid` bigint(20) DEFAULT NULL COMMENT '储值卡余额支付的金额,单位为分',
  `remark` varchar(255) DEFAULT NULL COMMENT '备注',
  `take_name` varchar(32) DEFAULT NULL COMMENT '收货人姓名',
  `take_phone` varchar(32) DEFAULT NULL COMMENT '收货人电话',
  `take_address` varchar(255) DEFAULT NULL COMMENT '收货地址',
  `province` varchar(32) DEFAULT NULL COMMENT '省',
  `city` varchar(32) DEFAULT NULL COMMENT '市',
  `circle` varchar(32) DEFAULT NULL COMMENT '区',
  `lmsg` varchar(500) DEFAULT NULL,
  `achieve_buyer_id` bigint(20) DEFAULT NULL COMMENT '动态订单接收的用户id，实现许愿，接收送礼',
  `refund_status` tinyint(3) DEFAULT NULL COMMENT '纪录用户提交退款时的状态',
  `modify_price` bigint(20) DEFAULT NULL COMMENT '修改的价格值，正表示价格比原来增加,负表示价格比原来减少,单位为分',
  `pay_way_list` varchar(128) DEFAULT NULL COMMENT '支付方式清单,选择配送方式后,对应的支付方式都保存到这里,以1,2,3形式保存,后面支付时提供多种选择',
  `create_time` datetime DEFAULT NULL,
  `edit_time` datetime DEFAULT NULL,
  `cost` bigint(20) DEFAULT NULL COMMENT '订单消费总金额，商品总额+运费,单位为分',
  `integral` bigint(20) DEFAULT NULL COMMENT '使用抵扣的积分',
  `transaction_no` varchar(64) DEFAULT NULL COMMENT '订单交易编号，（支付宝支付，微信支付时的交易编号）',
  `address_id` bigint(20) DEFAULT NULL COMMENT '地址id ,用于根据地址计算运费。',
  `pay_time` datetime DEFAULT NULL COMMENT '支付时间',
  `user_name` varchar(30) DEFAULT NULL COMMENT '用户姓名',
  `user_telphone` varchar(20) DEFAULT NULL COMMENT '用户手机',
  `id_card` varchar(25) DEFAULT NULL COMMENT '身份证',
  `order_source` tinyint(4) DEFAULT NULL COMMENT '订单来源 1=商城购买2=顾问推荐3=品牌分销',
  `store_dis_id` varchar(64) DEFAULT NULL COMMENT '分销门店',
  `store_dis_no` varchar(64) DEFAULT NULL COMMENT '分销编码',
  `store_ce` varchar(64) DEFAULT NULL COMMENT '门店分销收款单位',
  `store_send` varchar(64) DEFAULT NULL COMMENT '门店分销发货单位',
  `out_trade_no` varchar(64) DEFAULT NULL COMMENT '商户订单号,支付接口产生，用于对账',
  `delivery_belong` int(11) DEFAULT '0' COMMENT '订单发货门店所属1，商家（总店）发货，2 ，门店 发货,3上级发货',
  `order_belong` int(11) DEFAULT '0' COMMENT '订单所属 1，商家（总店），2 ，门店 ',
  `del` bit(1) DEFAULT b'0' COMMENT '0正常，1删除',
  `store_dis_status` tinyint(3) DEFAULT '0' COMMENT '分销门店订单状态1=门店正在处理;2=等待总店退款,3等待上级退款',
  `unpay_message_flag` int(1) DEFAULT '0' COMMENT '未支付的订单发送消息 0=未发送 1=已发送',
  `cus_region_1` varchar(128) DEFAULT NULL COMMENT '商家自定义配送区域一级',
  `cus_region_2` varchar(128) DEFAULT NULL COMMENT '商家自定义配送区域二级',
  `modify_freight` bigint(20) DEFAULT '0' COMMENT '修改后的运费价格,以分为单位',
  `reduce_price_fee` bigint(20) DEFAULT '0' COMMENT '减价 将分摊到子订单各个商品中,以分为单位',
  `reduce_time` datetime DEFAULT NULL COMMENT '修改分摊价格的时间',
  `reduce_man` varchar(64) DEFAULT NULL COMMENT '减价修改价格的人员 比如店员或店长或后台登陆人员',
  `check_man` varchar(64) DEFAULT NULL COMMENT '减价审核人员',
  `check_time` datetime DEFAULT NULL COMMENT '减价审核时间',
  `reduce_rrn` varchar(255) DEFAULT NULL COMMENT '减价拒绝原因',
  `check_status` tinyint(4) DEFAULT '0' COMMENT '减价审核状态 审核状态1=不需要审核2=系统审核3=待审核,4审核通过，5审核不通过',
  `modify_price_flag` bit(1) DEFAULT b'0' COMMENT '0=关闭 1=打开',
  `reduce_freight` bigint(20) DEFAULT '0' COMMENT '减价运费修改,以分为单位',
  `modify_price_reason` varchar(500) DEFAULT NULL COMMENT '修改价格原因',
  `sale_belong` int(11) DEFAULT '0' COMMENT '分销所属 1，店员，2 ，分销员 ',
  `sales_man_id` varchar(64) DEFAULT NULL COMMENT '店员id ',
  `set_meal_discount_fee` bigint(20) DEFAULT '0' COMMENT '套餐优惠的金额以分为单位',
  `sub_order_type` smallint(4) DEFAULT '0' COMMENT '订单细分类型,1=用户到店当面付类型',
  `ful_reduce_fee` bigint(20) DEFAULT NULL COMMENT '满减金额,单位为分',
  `unpay_balance_message_flag` int(1) DEFAULT '0' COMMENT '提醒开始付尾款的订单发送消息 0=未发送 1=已发送',
  `unpay_balaend_message_flag` int(1) DEFAULT '0' COMMENT '提醒开始付尾款的订单发送消息 0=未发送 1=已发送',
  `outtrade_last_no` varchar(64) DEFAULT NULL COMMENT '商户订单号(尾款),支付接口产生，用于对账',
  `transaction_last_no` varchar(64) DEFAULT NULL COMMENT '订单交易编号，尾款的（支付宝支付，微信支付时的交易编号）',
  `pay_last_time` datetime DEFAULT NULL COMMENT '尾款支付时间',
  `refund_presell_message_flag` int(1) DEFAULT '0' COMMENT '预售未成立自动申请退款发送信息 0=未发送 1=以发送',
  `huddle_team_id` varchar(64) DEFAULT NULL COMMENT '抱团成团id',
  `remarks` varchar(210) DEFAULT '' COMMENT '店员订单备注',
  `refund_type` tinyint(1) DEFAULT '0' COMMENT '退款类型 0=未退款 1=订单全部商品退款 2=订单部分商品退款',
  `refund_notice` tinyint(1) DEFAULT '1' COMMENT '0发送退款退款申请通知，1不发送退款申请通知',
  `actual_payment` bigint(20) DEFAULT '0' COMMENT '订单实付金额 支付多少算多少 包含余额(余额+支付宝+微信)',
  `has_refunding` tinyint(1) DEFAULT NULL COMMENT '是否有退款中的商品 0=没有 1=有',
  `order_ali_pay` bigint(20) DEFAULT NULL COMMENT '支付宝支付总额',
  `order_wx_pay` bigint(20) DEFAULT NULL COMMENT '微信支付总额',
  `delivery_store_id` varchar(64) DEFAULT NULL COMMENT '扣库存门店编号',
  `wish_under_message_flag` tinyint(1) DEFAULT '0' COMMENT '许愿众筹还剩24小时未筹满发送信息 0=未发送 1=已发送',
  `is_analysis` tinyint(1) DEFAULT '1' COMMENT '是否需要统计的数据 1=统计 0=不统计 许愿预售的后面支付的都不能统计',
  `is_union_sell` tinyint(1) DEFAULT '0' COMMENT '是否联合营销订单0=否1=是',
  `union_activity_id` varchar(64) DEFAULT NULL COMMENT '联合营销ID',
  `union_shopId` varchar(64) DEFAULT NULL COMMENT '联合营销源商家ID',
  `is_virtual` tinyint(1) DEFAULT '0' COMMENT '是否虚拟订单 0=否 1=是',
  `store_name` varchar(64) DEFAULT NULL COMMENT '订单所属门店名称',
  `emp_name` varchar(64) DEFAULT NULL COMMENT '订单所属店员名称',
  `fxy_name` varchar(64) DEFAULT NULL COMMENT '分销员名称',
  `pay_access` int(11) DEFAULT '0' COMMENT '支付计入方式，1 普通接入（公共号支付），2银行接入方式，微信支付的单才有值，非微信支付的为0',
  `wx_coupon_fee` bigint(20) DEFAULT NULL COMMENT '微信代金券，单位为分',
  PRIMARY KEY (`order_id`),
  KEY `idx_orders` (`buyer_id`),
  KEY `idx_orders_1` (`order_no`),
  KEY `idx_orders_2` (`edit_time`),
  KEY `idx_orders_3` (`shop_id`,`status`) USING BTREE,
  KEY `idx_orders_5` (`edit_time`,`status`) USING BTREE,
  KEY `idx_store_id` (`store_id`),
  KEY `idx_create_time` (`create_time`),
  KEY `idx_shop_buyer_id` (`shop_id`,`buyer_id`)
) ENGINE=InnoDB AUTO_INCREMENT=10028245 DEFAULT CHARSET=utf8 COMMENT='订单表'

CREATE TABLE `ordered_snapshot` (
  `id` int(64) NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `shop_id` varchar(64) DEFAULT NULL COMMENT '商家id',
  `order_no` varchar(64) DEFAULT NULL COMMENT '订单编号',
  `confirm_info` text COMMENT '确认订单信息',
  `orders_info` text COMMENT '下单信息',
  `detail_info` text COMMENT '订单明细信息',
  PRIMARY KEY (`id`),
  KEY `idx_ordered_snapshots_order_no` (`order_no`)
) ENGINE=InnoDB AUTO_INCREMENT=128 DEFAULT CHARSET=utf8 --订单快照.

CREATE TABLE `orders_comm` (
  `id` varchar(64) NOT NULL DEFAULT '' COMMENT '主键',
  `order_no` varchar(64) DEFAULT NULL COMMENT '订单编号',
  `detail_no` varchar(64) DEFAULT NULL COMMENT '订单明细号',
  `emp_id` varchar(64) DEFAULT NULL COMMENT '佣金所得人',
  `emp_status` int(11) DEFAULT '1' COMMENT '佣金所得人可算佣金状态0=是1=否',
  `emp_type` int(11) DEFAULT NULL COMMENT '佣金所得人类型0=店员1=合伙人',
  `sell_comm_type` int(11) DEFAULT '0' COMMENT '售出佣金类型0=百分比1=固定价',
  `sell_comm_rate` bigint(11) DEFAULT '0' COMMENT '售出佣金比例',
  `sell_comm` bigint(11) DEFAULT '0' COMMENT '售出佣金,单位:分',
  `service_comm_type` int(11) DEFAULT '0' COMMENT '服务佣金类型0=百分比1=固定价',
  `service_comm_rate` bigint(11) DEFAULT '0' COMMENT '服务佣金比例',
  `service_comm` bigint(11) DEFAULT '0' COMMENT '服务佣金,单位:分',
  `higher_comm_type` int(11) DEFAULT '0' COMMENT '上级提成类型0=百分比1=固定价',
  `higher_comm_rate` bigint(11) DEFAULT '0' COMMENT '上级提成比例',
  `higher_comm` bigint(11) DEFAULT '0' COMMENT '上级提成,单位:分',
  `super_comm_type` int(11) DEFAULT '0' COMMENT '上上级提成类型0=百分比1=固定价',
  `super_comm_rate` bigint(11) DEFAULT '0' COMMENT '上上级提成比例',
  `super_comm` bigint(11) DEFAULT '0' COMMENT '上上级提成,单位:分',
  `deep` int(11) DEFAULT NULL COMMENT '所属关系深度',
  `relation_ids` varchar(3000) DEFAULT NULL COMMENT '层级关系ID',
  `before_sell_comm` bigint(11) DEFAULT '0' COMMENT '改价之前的售出佣金',
  `before_service_comm` bigint(11) DEFAULT '0' COMMENT '改价之前的服务佣金',
  `before_higher_comm` bigint(11) DEFAULT '0' COMMENT '改价之前的上级提成',
  `before_super_comm` bigint(11) DEFAULT '0' COMMENT '改价之前的上上级提成',
  `expected_amount` bigint(11) DEFAULT '0' COMMENT '审核状态中，预计可能拿到的佣金',
  `devided` int(11) DEFAULT '0' COMMENT '分成状态0=未分成(未支付，支付失败)1=分成完成(支付成功)2=处理中(正在提交处理支付)',
  `pay_time` datetime DEFAULT NULL COMMENT '支付时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `idx_detail_no_emp_id` (`detail_no`,`emp_id`),
  KEY `idx_order_no` (`order_no`),
  KEY `idx_detail_no` (`detail_no`),
  KEY `idx_emp_id` (`emp_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='订单分佣表'

CREATE TABLE `buyer` (
  `buyer_id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT '买家id',
  `shop_id` varchar(46) DEFAULT NULL COMMENT '商家编号',
  `wxno` varchar(32) DEFAULT NULL COMMENT '微信号',
  `mobile` varchar(32) DEFAULT NULL COMMENT '手机',
  `password` varchar(32) DEFAULT NULL COMMENT '手机用户密码',
  `growup` bigint(1) DEFAULT NULL COMMENT '成长值',
  `integral` bigint(1) DEFAULT NULL COMMENT '积分',
  `stored` bigint(20) DEFAULT NULL COMMENT '储值额,以分为单位',
  `consume` bigint(20) DEFAULT NULL COMMENT '消费额,以分为单位',
  `buyer_type` tinyint(3) DEFAULT NULL COMMENT '买家类型1=微信2=手机',
  `hy_id` varchar(64) DEFAULT NULL COMMENT '华阳id',
  `name` varchar(32) DEFAULT NULL COMMENT '姓名',
  `nick` varchar(128) DEFAULT NULL,
  `photo` varchar(255) DEFAULT NULL COMMENT '头像',
  `sex` varchar(32) DEFAULT NULL COMMENT '性别',
  `birthday` varchar(255) DEFAULT NULL COMMENT '生日',
  `t_address` varchar(255) DEFAULT NULL COMMENT '收货地址',
  `birthday_rate` float DEFAULT NULL COMMENT '生日折扣',
  `level_goods_rate` float DEFAULT NULL COMMENT '粉丝等级商品折扣',
  `fans_leve_name` varchar(255) DEFAULT NULL COMMENT '粉丝等级名称',
  `address` varchar(255) DEFAULT NULL COMMENT '地址',
  `email` varchar(64) DEFAULT NULL COMMENT '邮箱',
  `province` varchar(32) DEFAULT NULL COMMENT '省',
  `city` varchar(32) DEFAULT NULL COMMENT '市',
  `county` varchar(32) DEFAULT NULL COMMENT '县(区)',
  `town` varchar(32) DEFAULT NULL COMMENT '镇(街道)',
  `icid` varchar(32) DEFAULT NULL,
  `refresh_token` datetime DEFAULT NULL,
  `remark` varchar(255) DEFAULT NULL,
  `shop_name` varchar(255) DEFAULT NULL,
  `sort_id` bigint(20) DEFAULT NULL,
  `sort_name` varchar(255) DEFAULT NULL,
  `refund_count` bigint(20) DEFAULT '0',
  `buy_idcard` varchar(25) DEFAULT NULL COMMENT '购买时候用户填写的身份证',
  PRIMARY KEY (`buyer_id`),
  KEY `idx_tbuyer_1` (`mobile`),
  KEY `idx_tbuyer_2` (`wxno`) USING BTREE,
  KEY `idx_tbuyer_3` (`buyer_id`,`buyer_type`) USING BTREE,
  KEY `idx_tbuyer_4` (`hy_id`) USING BTREE,
  KEY `idx_shop_id` (`shop_id`)
) ENGINE=InnoDB AUTO_INCREMENT=2817970 DEFAULT CHARSET=utf8 COMMENT='顾客'



